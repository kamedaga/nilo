// Dynamic Foreach „Éá„É¢
// ÂãïÁöÑ„É™„Çπ„Éà„Å®Áπ∞„ÇäËøî„ÅóÂá¶ÁêÜ„ÅÆ„É™„Ç¢„É´„Çø„Ç§„É†Ë°®Á§∫

flow {
    start: DynamicForeachDemo
}

timeline DynamicForeachDemo {
    font: "japanese"
    
    VStack(style: {
        width: 100ww, 
        height: 100wh, 
        background: "#0a0e27", 
        padding: 20,
        gap: 16px
    }) {
        // „Éò„ÉÉ„ÉÄ„ÉºÔºàÈùôÁöÑÔºâ
        VStack(style: {width: 100%, padding: [20, 0]}) {
            Text("ÔøΩ Dynamic Foreach „Éá„É¢ ÔøΩ", style: {
                font_size: 32px, 
                color: "#00d4ff"
            })
            Text("ÂãïÁöÑ„É™„Çπ„ÉàÂá¶ÁêÜ„Å®foreachÁπ∞„ÇäËøî„Åó„ÅÆ„É™„Ç¢„É´„Çø„Ç§„É†Ë°®Á§∫", style: {
                font_size: 16px, 
                color: "#a4f0ff"
            })
        }
        
        // ÂãïÁöÑForeach„Éá„É¢„Ç≥„É≥„ÉÜ„É≥„ÉÑ
        VStack(style: {width: 100%, gap: 20px}) {
            
            // Âü∫Êú¨ÁöÑ„Å™Foreach - ÈùôÁöÑÈÖçÂàó„ÅÆÁπ∞„ÇäËøî„Åó
            VStack(style: {
                background: "#1a2332",
                padding: 20,
                rounded: 12px,
                border_color: "#00d4ff"
            }) {
                Text("üìã Âü∫Êú¨ÁöÑ„Å™Foreach - ÈùôÁöÑÈÖçÂàó", style: {
                    font_size: 20px,
                    color: "#00d4ff",
                    padding: [0, 0, 12, 0]
                })
                
                Text("state.items „ÅÆÂÜÖÂÆπ:", style: {
                    font_size: 16px,
                    color: "#ffffff"
                })
                
                Text("DEBUG: state.items = {}", state.items, style: {
                    font_size: 14px,
                    color: "#ffff00"
                })
                
                dynamic_section static_foreach() {
                    VStack(style: {width: 100%, gap: 4px}) {
                        foreach item in state.items {
                            Text("„Ç¢„Ç§„ÉÜ„É†: {}", item, style: {
                                font_size: 14px,
                                color: "#a4f0ff",
                                padding: [4, 8]
                            })
                        }
                    }
                }
                
                Text("„Ç¢„Ç§„ÉÜ„É†Êï∞: {}", state.items_count, style: {
                    font_size: 14px,
                    color: "#00d4ff"
                })
            }
            
            // ÂãïÁöÑ„É™„Çπ„ÉàÂá¶ÁêÜ„ÅÆ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥
            VStack(style: {
                background: "#16213e",
                padding: 20,
                rounded: 12px,
                border_color: "#e94560"
            }) {
                Text("ÔøΩ Êï∞ÂÄ§ÁØÑÂõ≤„ÅÆForeach", style: {
                    font_size: 20px,
                    color: "#e94560",
                    padding: [0, 0, 12, 0]
                })
                
                Text("„Ç´„Ç¶„É≥„Çø„Éº„Å´Âü∫„Å•„ÅèÂãïÁöÑÁØÑÂõ≤:", style: {
                    font_size: 16px,
                    color: "#ffffff"
                })
                
                dynamic_section counter_foreach() {
                    VStack(style: {width: 100%, gap: 8px}) {
                        Text("ÁèæÂú®„ÅÆ„Ç´„Ç¶„É≥„Çø„Éº: {}", state.counter, style: {
                            font_size: 16px,
                            color: "#ffffff"
                        })
                        
                        if state.counter > 0 {
                            VStack(style: {width: 100%, gap: 4px}) {
                                Text("„Ç´„Ç¶„É≥„Çø„ÉºÂàÜ„ÅÆË¶ÅÁ¥†„ÇíË°®Á§∫:", style: {
                                    font_size: 14px,
                                    color: "#e94560"
                                })
                                
                                VStack(style: {width: 100%, gap: 2px, padding: [4, 0]}) {
                                    // „Ç´„Ç¶„É≥„Çø„Éº„ÅÆÂÄ§„Å´Âøú„Åò„Å¶ÂãïÁöÑ„Å´Ë¶ÅÁ¥†„ÇíË°®Á§∫
                                    if state.counter >= 1 {
                                        Text("‚Ä¢ Ë¶ÅÁ¥† 1", style: {color: "#ff6b6b", font_size: 14px, padding: [2, 0]})
                                    }
                                    if state.counter >= 2 {
                                        Text("‚Ä¢ Ë¶ÅÁ¥† 2", style: {color: "#4ecdc4", font_size: 14px, padding: [2, 0]})
                                    }
                                    if state.counter >= 3 {
                                        Text("‚Ä¢ Ë¶ÅÁ¥† 3", style: {color: "#45b7d1", font_size: 14px, padding: [2, 0]})
                                    }
                                    if state.counter >= 4 {
                                        Text("‚Ä¢ Ë¶ÅÁ¥† 4", style: {color: "#f9ca24", font_size: 14px, padding: [2, 0]})
                                    }
                                    if state.counter >= 5 {
                                        Text("‚Ä¢ Ë¶ÅÁ¥† 5", style: {color: "#6c5ce7", font_size: 14px, padding: [2, 0]})
                                    }
                                }
                            }
                        } else {
                            Text("„Ç´„Ç¶„É≥„Çø„Éº„Åå0‰ª•‰∏ã„Åß„Åô", style: {
                                font_size: 14px,
                                color: "#888888"
                            })
                        }
                    }
                }
            }
            
            // Êù°‰ª∂‰ªò„ÅçForeach
            VStack(style: {
                background: "#1a1a2e",
                padding: 20,
                rounded: 12px,
                border_color: "#a855f7"
            }) {
                Text("‚ú® Êù°‰ª∂‰ªò„ÅçForeach", style: {
                    font_size: 20px,
                    color: "#a855f7",
                    padding: [0, 0, 12, 0]
                })
                
                Text("„Éï„Ç£„É´„Çø„ÉºÁä∂ÊÖã„Å´Âøú„Åò„ÅüË°®Á§∫:", style: {
                    font_size: 16px,
                    color: "#ffffff"
                })
                
                dynamic_section filtered_foreach() {
                    VStack(style: {width: 100%, gap: 8px}) {
                        Text("„Éï„Ç£„É´„Çø„ÉºÊúâÂäπ: {}", match state.filter_enabled {
                            case true { "„ÅØ„ÅÑ" }
                            case false { "„ÅÑ„ÅÑ„Åà"  }
                        }, style: {
                            font_size: 16px,
                            color: "#a855f7"
                        })
                        
                        if state.filter_enabled {
                            VStack(style: {width: 100%, gap: 4px}) {
                                Text("„Éï„Ç£„É´„Çø„ÉºÈÅ©Áî®‰∏≠ - Â•áÊï∞„ÅÆ„ÅøË°®Á§∫:", style: {
                                    font_size: 14px,
                                    color: "#ffffff"
                                })
                                
                                VStack(style: {width: 100%, gap: 2px, padding: [4, 0]}) {
                                    foreach item in state.items {
                                        // Â•áÊï∞„ÅÆ„ÅøË°®Á§∫„Åô„ÇãÊù°‰ª∂
                                        if item == 1 {
                                            Text("‚úì Â•áÊï∞: {}", item, style: {
                                                font_size: 14px,
                                                color: "#10b981",
                                                padding: [2, 8]
                                            })
                                        }
                                        if item == 3 {
                                            Text("‚úì Â•áÊï∞: {}", item, style: {
                                                font_size: 14px,
                                                color: "#10b981",
                                                padding: [2, 8]
                                            })
                                        }
                                    }
                                }
                            }
                        } else {
                            VStack(style: {width: 100%, gap: 4px}) {
                                Text("„Éï„Ç£„É´„Çø„ÉºÁÑ°Âäπ - ÂÖ®„Å¶Ë°®Á§∫:", style: {
                                    font_size: 14px,
                                    color: "#ffffff"
                                })
                                
                                VStack(style: {width: 100%, gap: 2px, padding: [4, 0]}) {
                                    foreach item in state.items {
                                        Text("‚óã ÂÖ®„Å¶: {}", item, style: {
                                            font_size: 14px,
                                            color: "#8b5cf6",
                                            padding: [2, 8]
                                        })
                                    }
                                }
                            }
                        }
                    }
                }
            }
            
            // „É™„Ç¢„É´„Çø„Ç§„É†ÈÄ≤ÊçóË°®Á§∫
            VStack(style: {
                background: "#0f3460",
                padding: 20,
                rounded: 12px,
                border_color: "#fbbf24"
            }) {
                Text("‚è±Ô∏è „É™„Ç¢„É´„Çø„Ç§„É†ÈÄ≤ÊçóË°®Á§∫", style: {
                    font_size: 20px,
                    color: "#fbbf24",
                    padding: [0, 0, 12, 0]
                })
                
                Text("ÊôÇÈñìÁµåÈÅé„Å´„Çà„Çã„Éó„É≠„Ç∞„É¨„Çπ„Éê„Éº:", style: {
                    font_size: 16px,
                    color: "#ffffff"
                })
                
                dynamic_section progress_foreach() {
                    VStack(style: {width: 100%, gap: 8px}) {
                        Text("ÁµåÈÅéÊôÇÈñì: {:.1}Áßí", state.elapsed_time, style: {
                            font_size: 16px,
                            color: "#fbbf24"
                        })
                        
                        VStack(style: {width: 100%, gap: 4px}) {
                            Text("„Éó„É≠„Ç∞„É¨„Çπ:", style: {
                                font_size: 14px,
                                color: "#ffffff"
                            })
                            
                            // 10ÁßíÂë®Êúü„Åß„É™„Éî„Éº„Éà
                            VStack(style: {width: 100%, padding: [8, 0]}) {
                                // ÈÄ≤ÊçóË°®Á§∫ÔºàÁ∞°ÊòìÁâàÔºâ
                                HStack(style: {gap: 2px}) {
                                    Text("‚ñà", style: {color: "#10b981", font_size: 12px})
                                    Text("‚ñà", style: {color: "#10b981", font_size: 12px})
                                    Text("‚ñà", style: {color: "#10b981", font_size: 12px})
                                    Text("‚ñë", style: {color: "#374151", font_size: 12px})
                                    Text("‚ñë", style: {color: "#374151", font_size: 12px})
                                    Text("‚ñë", style: {color: "#374151", font_size: 12px})
                                    Text("‚ñë", style: {color: "#374151", font_size: 12px})
                                    Text("‚ñë", style: {color: "#374151", font_size: 12px})
                                    Text("‚ñë", style: {color: "#374151", font_size: 12px})
                                    Text("‚ñë", style: {color: "#374151", font_size: 12px})
                                }
                            }
                            
                            Text("ÈÄ≤ÊçóÁéá: 30%", style: {
                                font_size: 12px,
                                color: "#fbbf24"
                            })
                        }
                    }
                }
            }
        }
        
        // „Éï„ÉÉ„Çø„ÉºÊÉÖÂ†±
        dynamic_section footer_info(style: {
            background: "#0f1419",
            padding: 16,
            rounded: 8px,
            border_color: "#374151"
        }) {
            VStack(style: {width: 100%}) {
                Text("Nilo Dynamic Foreach Demo - ÂãïÁöÑÁπ∞„ÇäËøî„ÅóÂá¶ÁêÜ", style: {
                    font_size: 14px,
                    color: "#9ca3af"
                })
                Text("„Éï„É¨„Éº„É†: {} | „Ç¢„Ç§„ÉÜ„É†Êï∞: {} | „Éï„Ç£„É´„Çø„Éº: {}", state.frame_count, state.items_count, match state.filter_enabled {
                    case true { "ON" }
                    case false { "OFF" }
                }, style: {
                    font_size: 14px,
                    color: "#9ca3af"
                })
            }
        }
    }
}